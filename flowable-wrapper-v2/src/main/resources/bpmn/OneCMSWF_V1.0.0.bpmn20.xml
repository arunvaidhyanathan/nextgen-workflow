<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:flowable="http://flowable.org/bpmn" targetNamespace="http://www.eo.com/workflow" exporter="Camunda Modeler" exporterVersion="5.35.0">
  <process id="eoCaseWorkflow" name="EO Case Management Workflow" isExecutable="true">
    <laneSet>
      <lane id="lane_eo_intake" name="EO Intake">
        <flowNodeRef>start_eo_case_received</flowNodeRef>
        <flowNodeRef>task_eo_intake</flowNodeRef>
        <flowNodeRef>task_claim_case</flowNodeRef>
      </lane>
      <lane id="lane_department_analysts" name="Department Analysts">
        <flowNodeRef>gateway_eo_analyst_decision</flowNodeRef>
        <flowNodeRef>task_eo_officer_review</flowNodeRef>
      </lane>
      <lane id="lane_eo_officer" name="EO Officer">
        <flowNodeRef>gateway_eo_officer_decision</flowNodeRef>
        <flowNodeRef>task_eo_head_review</flowNodeRef>
        <flowNodeRef>gateway_eo_head_decision</flowNodeRef>
        <flowNodeRef>end_case_approved</flowNodeRef>
        <flowNodeRef>end_case_rejected</flowNodeRef>
      </lane>
    </laneSet>


<startEvent id="start_eo_case_received" name="EO Case Received" flowable:initiator="initiator">
  <extensionElements>
    <flowable:executionListener event="start" expression="${execution.setVariable('caseState', 'RECEIVED')}" />
    <flowable:executionListener event="start" expression="${execution.setVariable('caseCreatedDate', 'now')}" />
    <flowable:executionListener event="start" expression="${execution.setVariable('caseCreatedBy', initiator)}" />
  </extensionElements>
</startEvent>

  <serviceTask id="task_claim_case" name="Claim Case" flowable:expression="${execution.setVariable('caseClaimed', true)}">
      <documentation>Initial case claiming by EO Intake team</documentation>
      <incoming>flow_start_to_claim</incoming>
      <outgoing>flow_claim_to_intake</outgoing>
    </serviceTask>

<userTask id="task_eo_intake" name="EO Intake" 
          flowable:assignee="${initiator}" 
          flowable:candidateGroups="GROUP_EO_INTAKE_ANALYST">
  <documentation>Process case intake - Auto-assigned with intelligent fallback</documentation>
  <extensionElements>
    <!-- Task Creation Events -->
    <flowable:executionListener event="create" expression="${execution.setVariable('intakeAssignedDate', 'now')}" />
    <flowable:executionListener event="create" expression="${execution.setVariable('originalAssignee', initiator)}" />
    <flowable:executionListener event="create" expression="${execution.setVariable('caseClaimed', true)}" />
    <flowable:executionListener event="create" expression="${execution.setVariable('claimTimestamp', 'now')}" />
    
    <!-- Task Assignment Events -->
    <flowable:executionListener event="assignment" expression="${execution.setVariable('currentAssignee', task.getAssignee())}" />
    <flowable:executionListener event="assignment" expression="${execution.setVariable('claimedBy', task.getAssignee())}" />
    <flowable:executionListener event="assignment" expression="${execution.setVariable('reassignmentCount', (reassignmentCount != null ? reassignmentCount + 1 : 1))}" />
    
    <!-- Task Start Events -->
    <flowable:executionListener event="start" expression="${execution.setVariable('caseState', 'IN_INTAKE')}" />
    <flowable:executionListener event="start" expression="${execution.setVariable('intakeStartedDate', 'now')}" />
  </extensionElements>
</userTask>

    
    <exclusiveGateway id="gateway_eo_analyst_decision" name="EO Analyst Decision" />
    <userTask id="task_eo_officer_review" name="EO Officer Review" flowable:candidateGroups="GROUP_EO_OFFICER">
      <documentation>EO Officer reviews case and makes routing decision</documentation>
    </userTask>
    <exclusiveGateway id="gateway_eo_officer_decision" name="EO Officer Decision" />
    <userTask id="task_eo_head_review" name="EO Head Review" flowable:candidateGroups="GROUP_EO_HEAD">
      <documentation>EO Head reviews case for final decision</documentation>
    </userTask>
    <exclusiveGateway id="gateway_eo_head_decision" name="EO Head Decision" />
    <endEvent id="end_case_approved" name="Case Approved">
      <extensionElements>
        <flowable:executionListener event="start" expression="${execution.setVariable(&#39;caseState&#39;, &#39;APPROVED&#39;)}" />
      </extensionElements>
    </endEvent>
    <endEvent id="end_case_rejected" name="Case Rejected">
      <extensionElements>
        <flowable:executionListener event="start" expression="${execution.setVariable(&#39;caseState&#39;, &#39;REJECTED&#39;)}" />
      </extensionElements>
    </endEvent>
    <sequenceFlow id="flow_start_to_claim" sourceRef="start_eo_case_received" targetRef="task_claim_case" />
    <sequenceFlow id="flow_claim_to_intake" sourceRef="task_claim_case" targetRef="task_eo_intake" />
    <sequenceFlow id="flow_intake_to_analyst_decision" sourceRef="task_eo_intake" targetRef="gateway_eo_analyst_decision" />
    <sequenceFlow id="flow_analyst_approve" name="EO Approve" sourceRef="gateway_eo_analyst_decision" targetRef="task_eo_head_review">
      <conditionExpression xsi:type="tFormalExpression">${eoAnalystAction == 'APPROVE'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_analyst_to_officer" name="Send to EO Officer" sourceRef="gateway_eo_analyst_decision" targetRef="task_eo_officer_review">
      <conditionExpression xsi:type="tFormalExpression">${eoAnalystAction == 'SEND_TO_OFFICER'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_analyst_reject" name="EO Reject Request" sourceRef="gateway_eo_analyst_decision" targetRef="end_case_rejected">
      <conditionExpression xsi:type="tFormalExpression">${eoAnalystAction == 'REJECT'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_analyst_send_back" name="Send Back to EO Analyst" sourceRef="gateway_eo_analyst_decision" targetRef="task_eo_intake">
      <conditionExpression xsi:type="tFormalExpression">${eoAnalystAction == 'SEND_BACK'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_officer_to_decision" sourceRef="task_eo_officer_review" targetRef="gateway_eo_officer_decision" />
    <sequenceFlow id="flow_officer_approve" name="EO Approve" sourceRef="gateway_eo_officer_decision" targetRef="task_eo_head_review">
      <conditionExpression xsi:type="tFormalExpression">${eoOfficerAction == 'APPROVE'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_officer_send_back" name="Send Back to EO Analyst" sourceRef="gateway_eo_officer_decision" targetRef="task_eo_intake">
      <conditionExpression xsi:type="tFormalExpression">${eoOfficerAction == 'SEND_BACK'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_head_to_decision" sourceRef="task_eo_head_review" targetRef="gateway_eo_head_decision" />
    <sequenceFlow id="flow_head_approve" name="Reject Approved" sourceRef="gateway_eo_head_decision" targetRef="end_case_approved">
      <conditionExpression xsi:type="tFormalExpression">${eoHeadAction == 'APPROVE'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_head_reject" name="Reject Approved" sourceRef="gateway_eo_head_decision" targetRef="end_case_rejected">
      <conditionExpression xsi:type="tFormalExpression">${eoHeadAction == 'REJECT'}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow_head_send_back" name="Send Back to EO Analyst" sourceRef="gateway_eo_head_decision" targetRef="task_eo_intake">
      <conditionExpression xsi:type="tFormalExpression">${eoHeadAction == 'SEND_BACK'}</conditionExpression>
    </sequenceFlow>

  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_eoCaseWorkflow">
    <bpmndi:BPMNPlane id="BPMNPlane_eoCaseWorkflow" bpmnElement="eoCaseWorkflow">
      <bpmndi:BPMNShape id="BPMNShape_lane_eo_officer" bpmnElement="lane_eo_officer" isHorizontal="true">
        <omgdc:Bounds x="160" y="350" width="1200" height="150" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="30" y="415" width="30" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_lane_department_analysts" bpmnElement="lane_department_analysts" isHorizontal="true">
        <omgdc:Bounds x="160" y="200" width="1200" height="150" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="30" y="265" width="30" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_lane_eo_intake" bpmnElement="lane_eo_intake" isHorizontal="true">
        <omgdc:Bounds x="160" y="50" width="1200" height="150" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="30" y="115" width="30" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_start_eo_case_received" bpmnElement="start_eo_case_received">
        <omgdc:Bounds x="210" y="105" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="196" y="145" width="64" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_task_eo_intake" bpmnElement="task_eo_intake">
        <omgdc:Bounds x="430" y="83" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_gateway_eo_analyst_decision" bpmnElement="gateway_eo_analyst_decision" isMarkerVisible="true">
        <omgdc:Bounds x="575" y="250" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="555" y="305" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_task_eo_officer_review" bpmnElement="task_eo_officer_review">
        <omgdc:Bounds x="430" y="235" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_gateway_eo_officer_decision" bpmnElement="gateway_eo_officer_decision" isMarkerVisible="true">
        <omgdc:Bounds x="455" y="400" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="435" y="455" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_task_eo_head_review" bpmnElement="task_eo_head_review">
        <omgdc:Bounds x="710" y="385" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_gateway_eo_head_decision" bpmnElement="gateway_eo_head_decision" isMarkerVisible="true">
        <omgdc:Bounds x="855" y="400" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="835" y="455" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_end_case_approved" bpmnElement="end_case_approved">
        <omgdc:Bounds x="950" y="355" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="932" y="395" width="72" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_end_case_rejected" bpmnElement="end_case_rejected">
        <omgdc:Bounds x="950" y="445" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="932" y="485" width="72" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1y3p98v_di" bpmnElement="task_claim_case">
        <omgdc:Bounds x="290" y="83" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_start_to_claim" bpmnElement="flow_start_to_claim">
        <omgdi:waypoint x="246" y="123" />
        <omgdi:waypoint x="290" y="123" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_claim_to_intake" bpmnElement="flow_claim_to_intake">
        <omgdi:waypoint x="390" y="123" />
        <omgdi:waypoint x="430" y="123" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_intake_to_analyst_decision" bpmnElement="flow_intake_to_analyst_decision">
        <omgdi:waypoint x="480" y="163" />
        <omgdi:waypoint x="480" y="209" />
        <omgdi:waypoint x="600" y="209" />
        <omgdi:waypoint x="600" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_analyst_approve" bpmnElement="flow_analyst_approve">
        <omgdi:waypoint x="625" y="275" />
        <omgdi:waypoint x="760" y="275" />
        <omgdi:waypoint x="760" y="385" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="659" y="257" width="60" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_analyst_to_officer" bpmnElement="flow_analyst_to_officer">
        <omgdi:waypoint x="575" y="275" />
        <omgdi:waypoint x="530" y="275" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="495" y="257" width="85" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_analyst_reject" bpmnElement="flow_analyst_reject">
        <omgdi:waypoint x="625" y="275" />
        <omgdi:waypoint x="968" y="275" />
        <omgdi:waypoint x="968" y="445" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="785" y="257" width="89" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_analyst_send_back" bpmnElement="flow_analyst_send_back">
        <omgdi:waypoint x="585" y="260" />
        <omgdi:waypoint x="585" y="180" />
        <omgdi:waypoint x="480" y="180" />
        <omgdi:waypoint x="480" y="163" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="495" y="185" width="85" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_officer_to_decision" bpmnElement="flow_officer_to_decision">
        <omgdi:waypoint x="480" y="315" />
        <omgdi:waypoint x="480" y="400" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_officer_approve" bpmnElement="flow_officer_approve">
        <omgdi:waypoint x="505" y="425" />
        <omgdi:waypoint x="710" y="425" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="575" y="407" width="60" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_officer_send_back" bpmnElement="flow_officer_send_back">
        <omgdi:waypoint x="465" y="410" />
        <omgdi:waypoint x="410" y="410" />
        <omgdi:waypoint x="410" y="180" />
        <omgdi:waypoint x="480" y="180" />
        <omgdi:waypoint x="480" y="163" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="325" y="290" width="85" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_head_to_decision" bpmnElement="flow_head_to_decision">
        <omgdi:waypoint x="810" y="425" />
        <omgdi:waypoint x="855" y="425" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_head_approve" bpmnElement="flow_head_approve">
        <omgdi:waypoint x="885" y="410" />
        <omgdi:waypoint x="920" y="410" />
        <omgdi:waypoint x="920" y="373" />
        <omgdi:waypoint x="950" y="373" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="875" y="365" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_head_reject" bpmnElement="flow_head_reject">
        <omgdi:waypoint x="885" y="440" />
        <omgdi:waypoint x="920" y="440" />
        <omgdi:waypoint x="920" y="463" />
        <omgdi:waypoint x="950" y="463" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="875" y="470" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="BPMNEdge_flow_head_send_back" bpmnElement="flow_head_send_back">
        <omgdi:waypoint x="865" y="410" />
        <omgdi:waypoint x="865" y="180" />
        <omgdi:waypoint x="480" y="180" />
        <omgdi:waypoint x="480" y="163" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="645" y="185" width="85" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
